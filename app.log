2025-03-10 23:55:03,429 - INFO - Created new Redis connection pool at localhost:6379
2025-03-10 23:55:03,429 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:57:05,800 - INFO - Database connection successful.
2025-03-10 23:57:05,808 - INFO - Database connection closed.
2025-03-10 23:57:05,820 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:57:05,827 - INFO - Database connection closed.
2025-03-10 23:58:00,879 - INFO - Database connection successful.
2025-03-10 23:58:00,880 - INFO - Database connection closed.
2025-03-10 23:58:00,924 - INFO - Database connection successful.
2025-03-10 23:58:00,928 - INFO - Database connection closed.
2025-03-10 23:58:00,938 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:00,939 - INFO - Database connection successful.
2025-03-10 23:58:00,941 - INFO - Database connection closed.
2025-03-10 23:58:00,942 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:06,496 - ERROR - WebSocket error: user_id=67cdc690ceb8b63cb3849cd8, error=(1001, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1001, '')
2025-03-10 23:58:06,498 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:06,499 - INFO - WebSocket connection closed: user_id=67cdc690ceb8b63cb3849cd8, websocket_id=137897995280912
2025-03-10 23:58:06,678 - INFO - Database connection successful.
2025-03-10 23:58:06,680 - INFO - Database connection closed.
2025-03-10 23:58:06,689 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:06,694 - INFO - Database connection closed.
2025-03-10 23:58:08,745 - ERROR - WebSocket error: user_id=67cdc690ceb8b63cb3849cd8, error=(1001, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1001, '')
2025-03-10 23:58:08,746 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:08,747 - INFO - WebSocket connection closed: user_id=67cdc690ceb8b63cb3849cd8, websocket_id=137897984241072
2025-03-10 23:58:08,868 - INFO - Database connection successful.
2025-03-10 23:58:08,869 - INFO - Database connection closed.
2025-03-10 23:58:08,888 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:08,890 - INFO - Database connection closed.
2025-03-10 23:58:14,786 - ERROR - WebSocket error: user_id=67cdc690ceb8b63cb3849cd8, error=(1001, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1001, '')
2025-03-10 23:58:14,787 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:14,789 - INFO - WebSocket connection closed: user_id=67cdc690ceb8b63cb3849cd8, websocket_id=137897983188176
2025-03-10 23:58:21,945 - INFO - Database connection successful.
2025-03-10 23:58:21,946 - INFO - Database connection closed.
2025-03-10 23:58:21,986 - INFO - Database connection successful.
2025-03-10 23:58:21,990 - INFO - Database connection closed.
2025-03-10 23:58:21,995 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:21,996 - INFO - Database connection successful.
2025-03-10 23:58:21,998 - INFO - Database connection closed.
2025-03-10 23:58:21,998 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:23,476 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:23,550 - INFO - Database connection closed.
2025-03-10 23:58:26,765 - INFO - Database connection closed.
2025-03-10 23:58:34,943 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:34,944 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:38,461 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:38,461 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:39,841 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:39,841 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:39,841 - INFO - Entering finally block
2025-03-10 23:58:39,851 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:39,869 - INFO - Database connection closed.
2025-03-10 23:58:40,854 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-10 23:58:40,855 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-10 23:58:40,855 - INFO - Entering finally block
2025-03-10 23:58:40,877 - INFO - Database connection closed.
2025-03-10 23:58:49,381 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:49,382 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:58:50,931 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:50,931 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:50,931 - INFO - Entering finally block
2025-03-10 23:58:50,946 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:50,956 - INFO - Database connection closed.
2025-03-10 23:58:51,856 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-10 23:58:51,856 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-10 23:58:51,856 - INFO - Entering finally block
2025-03-10 23:58:51,883 - INFO - Database connection closed.
2025-03-10 23:58:52,910 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:52,911 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:58:52,911 - INFO - Entering finally block
2025-03-10 23:58:52,921 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-10 23:58:52,942 - INFO - Database connection closed.
2025-03-10 23:58:58,759 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c2e88b53474c286895498b, group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-10 23:58:58,759 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-10 23:58:58,759 - INFO - Entering finally block
2025-03-10 23:58:58,779 - INFO - Database connection closed.
2025-03-10 23:59:02,116 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:02,117 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:02,117 - INFO - Entering finally block
2025-03-10 23:59:02,135 - INFO - Database connection closed.
2025-03-10 23:59:02,815 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-10 23:59:02,815 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-10 23:59:02,815 - INFO - Entering finally block
2025-03-10 23:59:02,837 - INFO - Database connection closed.
2025-03-10 23:59:09,029 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:09,029 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:09,029 - INFO - Entering finally block
2025-03-10 23:59:09,034 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-10 23:59:09,035 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:59:09,035 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:09,035 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-10 23:59:09,035 - INFO - Entering finally block
2025-03-10 23:59:09,038 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-10 23:59:09,039 - INFO - Returning Redis client instance from connection pool
2025-03-10 23:59:09,041 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=137897983182992
2025-03-10 23:59:09,043 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=137897994543200
2025-03-10 23:59:10,581 - INFO - Created new Redis connection pool at localhost:6379
2025-03-10 23:59:10,581 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:00:11,746 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:00:11,746 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:00:18,373 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:00:18,373 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:00:31,640 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:00:31,651 - INFO - Database connection closed.
2025-03-11 00:00:33,022 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:00:33,022 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:00:33,022 - INFO - Entering finally block
2025-03-11 00:00:33,022 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:00:33,022 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:00:33,023 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:00:33,024 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:00:33,024 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:00:33,034 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:00:33,054 - INFO - Database connection closed.
2025-03-11 00:02:07,002 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:02:07,003 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:02:07,003 - INFO - Entering finally block
2025-03-11 00:02:07,003 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:02:07,003 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:02:07,004 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:02:07,005 - INFO - Listener for group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827 stopped.
2025-03-11 00:02:07,005 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:02:07,019 - INFO - Database connection successful.
2025-03-11 00:02:07,020 - INFO - Database connection closed.
2025-03-11 00:02:08,626 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:02:08,626 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:02:47,910 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:02:47,910 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:02:56,403 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:02:56,403 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:03:10,355 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:03:10,355 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:03:18,895 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:03:18,895 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:03:35,524 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:03:35,524 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:04:31,103 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:04:31,103 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:04:56,445 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:04:56,446 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:04:59,680 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:04:59,680 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:10,692 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:10,700 - INFO - Database connection successful.
2025-03-11 00:05:10,701 - INFO - Database connection closed.
2025-03-11 00:05:10,702 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:10,719 - INFO - Database connection successful.
2025-03-11 00:05:10,720 - INFO - Database connection closed.
2025-03-11 00:05:12,861 - INFO - Database connection successful.
2025-03-11 00:05:12,863 - INFO - Database connection closed.
2025-03-11 00:05:12,869 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:12,870 - INFO - Database connection successful.
2025-03-11 00:05:12,871 - INFO - Database connection closed.
2025-03-11 00:05:12,872 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:14,405 - CRITICAL - Unexpected error during fetching chats: 'coroutine' object has no attribute 'lrange'
2025-03-11 00:05:14,408 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:05:14,427 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:14,430 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:14,432 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:14,432 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:14,432 - INFO - Entering finally block
2025-03-11 00:05:14,432 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:14,432 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:14,433 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:14,434 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:05:14,434 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:15,428 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(<CloseCode.NO_STATUS_RCVD: 1005>, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
2025-03-11 00:05:15,429 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:15,430 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=123428174951152
2025-03-11 00:05:21,283 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1001, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1001, '')
2025-03-11 00:05:21,284 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:21,285 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=123428175570048
2025-03-11 00:05:21,395 - INFO - Database connection successful.
2025-03-11 00:05:21,397 - INFO - Database connection closed.
2025-03-11 00:05:21,403 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:21,406 - INFO - Database connection successful.
2025-03-11 00:05:21,411 - INFO - Database connection closed.
2025-03-11 00:05:21,412 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:32,664 - INFO - Database connection successful.
2025-03-11 00:05:32,665 - INFO - Database connection closed.
2025-03-11 00:05:32,707 - INFO - Database connection successful.
2025-03-11 00:05:32,709 - INFO - Database connection closed.
2025-03-11 00:05:32,715 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:32,716 - INFO - Database connection successful.
2025-03-11 00:05:32,718 - INFO - Database connection closed.
2025-03-11 00:05:32,718 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:34,612 - CRITICAL - Unexpected error during fetching chats: 'coroutine' object has no attribute 'lrange'
2025-03-11 00:05:34,615 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:05:34,642 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:34,644 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:34,645 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:34,645 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:34,645 - INFO - Entering finally block
2025-03-11 00:05:34,645 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:34,645 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:34,646 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:34,646 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:05:34,647 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:05:35,643 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(<CloseCode.NO_STATUS_RCVD: 1005>, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
2025-03-11 00:05:35,643 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:05:35,644 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=123428104408528
2025-03-11 00:05:53,960 - ERROR - Database error: 401: Incorrect email or password
2025-03-11 00:05:53,961 - INFO - Database connection closed.
2025-03-11 00:05:55,702 - ERROR - Database error: 401: Incorrect email or password
2025-03-11 00:05:55,703 - INFO - Database connection closed.
2025-03-11 00:06:03,328 - ERROR - Database error: 401: Incorrect email or password
2025-03-11 00:06:03,329 - INFO - Database connection closed.
2025-03-11 00:06:08,003 - INFO - Database connection successful.
2025-03-11 00:06:08,004 - INFO - Database connection closed.
2025-03-11 00:06:08,049 - INFO - Database connection successful.
2025-03-11 00:06:08,051 - INFO - Database connection closed.
2025-03-11 00:06:08,065 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:08,067 - INFO - Database connection successful.
2025-03-11 00:06:08,070 - INFO - Database connection closed.
2025-03-11 00:06:08,070 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:10,232 - CRITICAL - Unexpected error during fetching chats: 'coroutine' object has no attribute 'lrange'
2025-03-11 00:06:10,235 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:06:10,251 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:10,253 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:10,254 - WARNING - WebSocket disconnected: current_user=67c27b205ae9c75d5093cdbe, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:06:10,254 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:06:10,254 - INFO - Entering finally block
2025-03-11 00:06:10,254 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:06:10,255 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:06:10,255 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:10,256 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:06:10,256 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:06:11,252 - ERROR - WebSocket error: user_id=67c27b205ae9c75d5093cdbe, error=(<CloseCode.NO_STATUS_RCVD: 1005>, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
2025-03-11 00:06:11,252 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:06:11,254 - INFO - WebSocket connection closed: user_id=67c27b205ae9c75d5093cdbe, websocket_id=123428175567600
2025-03-11 00:08:11,252 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:08:11,253 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:11,255 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=123428105045920
2025-03-11 00:08:12,918 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:08:12,919 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:26,475 - INFO - Database connection successful.
2025-03-11 00:08:26,478 - INFO - Database connection closed.
2025-03-11 00:08:26,483 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:26,488 - INFO - Database connection successful.
2025-03-11 00:08:26,489 - INFO - Database connection closed.
2025-03-11 00:08:26,489 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:29,890 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:08:29,896 - CRITICAL - Unexpected error during fetching chats: 'coroutine' object has no attribute 'lrange'
2025-03-11 00:08:29,915 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:29,916 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:29,918 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c439e8c178f84e2942da67, group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:08:29,918 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:08:29,919 - INFO - Entering finally block
2025-03-11 00:08:29,919 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:08:29,919 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:08:29,920 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:29,921 - INFO - Listener for group 67c20beebeb874032b0c381c-67c439e8c178f84e2942da67 stopped.
2025-03-11 00:08:29,921 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:08:30,915 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(<CloseCode.NO_STATUS_RCVD: 1005>, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
2025-03-11 00:08:30,916 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:08:30,917 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=134547333684048
2025-03-11 00:09:41,457 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:09:41,457 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:43,457 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:09:43,458 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:50,694 - INFO - Database connection successful.
2025-03-11 00:09:50,695 - INFO - Database connection closed.
2025-03-11 00:09:50,741 - INFO - Database connection successful.
2025-03-11 00:09:50,742 - INFO - Database connection closed.
2025-03-11 00:09:50,764 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:50,768 - INFO - Database connection successful.
2025-03-11 00:09:50,769 - INFO - Database connection closed.
2025-03-11 00:09:50,769 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:51,873 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:09:51,878 - CRITICAL - Unexpected error during fetching chats: 'coroutine' object has no attribute 'lrange'
2025-03-11 00:09:51,896 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:51,897 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:51,899 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:09:51,900 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:09:51,900 - INFO - Entering finally block
2025-03-11 00:09:51,900 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:09:51,900 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:09:51,901 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:51,902 - INFO - Listener for group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827 stopped.
2025-03-11 00:09:51,902 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:09:52,896 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(<CloseCode.NO_STATUS_RCVD: 1005>, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
2025-03-11 00:09:52,897 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:09:52,898 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=134867006938176
2025-03-11 00:10:19,420 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:10:19,420 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:28,341 - INFO - Database connection successful.
2025-03-11 00:10:28,342 - INFO - Database connection closed.
2025-03-11 00:10:28,388 - INFO - Database connection successful.
2025-03-11 00:10:28,389 - INFO - Database connection closed.
2025-03-11 00:10:28,419 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:28,424 - INFO - Database connection successful.
2025-03-11 00:10:28,426 - INFO - Database connection closed.
2025-03-11 00:10:28,427 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:29,433 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:10:29,438 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:29,454 - INFO - Database connection closed.
2025-03-11 00:10:30,693 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:10:30,694 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:10:30,694 - INFO - Entering finally block
2025-03-11 00:10:30,694 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:10:30,694 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:10:30,695 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:30,695 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:10:30,696 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:10:30,698 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:30,700 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:10:30,716 - INFO - Database connection closed.
2025-03-11 00:10:44,198 - INFO - Database connection successful.
2025-03-11 00:10:44,199 - INFO - Database connection closed.
2025-03-11 00:10:44,239 - INFO - Database connection successful.
2025-03-11 00:10:44,240 - INFO - Database connection closed.
2025-03-11 00:10:44,253 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:44,255 - INFO - Database connection successful.
2025-03-11 00:10:44,256 - INFO - Database connection closed.
2025-03-11 00:10:44,257 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:46,046 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:10:46,066 - INFO - Database connection closed.
2025-03-11 00:11:03,046 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:03,047 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:09,291 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:09,292 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:13,640 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:13,640 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:13,640 - INFO - Entering finally block
2025-03-11 00:11:13,641 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:13,641 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:13,649 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:13,651 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:13,665 - INFO - Database connection successful.
2025-03-11 00:11:13,667 - INFO - Database connection closed.
2025-03-11 00:11:13,670 - INFO - Database connection closed.
2025-03-11 00:11:15,304 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:15,305 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:15,305 - INFO - Entering finally block
2025-03-11 00:11:15,305 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:15,305 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:15,306 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:15,306 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:11:15,307 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:15,309 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:15,323 - INFO - Database connection closed.
2025-03-11 00:11:17,855 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:17,855 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:17,855 - INFO - Entering finally block
2025-03-11 00:11:17,855 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:17,856 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:17,861 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:17,867 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:17,877 - INFO - Database connection closed.
2025-03-11 00:11:19,489 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c2e88b53474c286895498b, group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:19,489 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:19,490 - INFO - Entering finally block
2025-03-11 00:11:19,490 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:19,490 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:19,490 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:19,491 - INFO - Listener for group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b stopped.
2025-03-11 00:11:19,491 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:19,494 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:19,508 - INFO - Database connection closed.
2025-03-11 00:11:34,793 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:34,793 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:34,793 - INFO - Entering finally block
2025-03-11 00:11:34,793 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:34,794 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:34,797 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:34,800 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:34,811 - INFO - Database connection closed.
2025-03-11 00:11:35,807 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c2e88b53474c286895498b, group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:35,808 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:35,808 - INFO - Entering finally block
2025-03-11 00:11:35,808 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:35,809 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:35,809 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:35,810 - INFO - Listener for group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b stopped.
2025-03-11 00:11:35,810 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:11:35,812 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:35,828 - INFO - Database connection closed.
2025-03-11 00:11:37,209 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:37,209 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:37,210 - INFO - Entering finally block
2025-03-11 00:11:37,210 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:11:37,210 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:37,213 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:37,221 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:11:37,232 - INFO - Database connection closed.
2025-03-11 00:11:38,144 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:38,144 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:38,144 - INFO - Entering finally block
2025-03-11 00:11:38,144 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:38,144 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:38,145 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:38,145 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:11:38,146 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:11:38,148 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:11:38,168 - INFO - Database connection closed.
2025-03-11 00:13:05,116 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:13:05,118 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:05,119 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,119 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,119 - INFO - Entering finally block
2025-03-11 00:13:05,119 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,120 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,120 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,120 - INFO - Entering finally block
2025-03-11 00:13:05,120 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:13:05,120 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:13:05,121 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:05,123 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:05,123 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:05,124 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=134853377758496
2025-03-11 00:13:05,124 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=134853317648384
2025-03-11 00:13:06,193 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:13:06,193 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:41,324 - INFO - Database connection successful.
2025-03-11 00:13:41,327 - INFO - Database connection closed.
2025-03-11 00:13:41,331 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:41,335 - INFO - Database connection successful.
2025-03-11 00:13:41,336 - INFO - Database connection closed.
2025-03-11 00:13:41,337 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:43,225 - INFO - Database connection successful.
2025-03-11 00:13:43,228 - INFO - Database connection closed.
2025-03-11 00:13:43,234 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:43,235 - INFO - Database connection successful.
2025-03-11 00:13:43,236 - INFO - Database connection closed.
2025-03-11 00:13:43,237 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:44,350 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:44,353 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:13:44,370 - INFO - Database connection closed.
2025-03-11 00:13:45,943 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:13:45,959 - INFO - Database connection closed.
2025-03-11 00:13:59,105 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:13:59,106 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:14:04,042 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:14:04,043 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:14:05,606 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:14:05,606 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:14:05,606 - INFO - Entering finally block
2025-03-11 00:14:05,606 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:14:05,611 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:14:05,613 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:14:05,629 - INFO - Database connection closed.
2025-03-11 00:14:07,189 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:14:07,190 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:14:07,190 - INFO - Entering finally block
2025-03-11 00:14:07,190 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:14:07,190 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:14:07,190 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:14:07,191 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:14:07,194 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:14:07,210 - INFO - Database connection closed.
2025-03-11 00:15:00,452 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:15:00,453 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:00,454 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,454 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,454 - INFO - Entering finally block
2025-03-11 00:15:00,454 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,454 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,454 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,454 - INFO - Entering finally block
2025-03-11 00:15:00,455 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:15:00,455 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:15:00,455 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:00,457 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=124147445766800
2025-03-11 00:15:00,458 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=124147471818848
2025-03-11 00:15:01,463 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:15:01,463 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:12,164 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:12,168 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:12,189 - INFO - Database connection closed.
2025-03-11 00:15:13,500 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:15:13,500 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:15:13,501 - INFO - Entering finally block
2025-03-11 00:15:13,501 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:15:13,501 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:15:13,501 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:15:13,501 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:15:13,507 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:13,510 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:13,525 - INFO - Database connection closed.
2025-03-11 00:15:29,057 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:29,058 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:31,986 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:31,987 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:37,034 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:37,034 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:43,488 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:43,488 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:15:49,485 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:15:49,486 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:01,494 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:01,495 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:03,470 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:03,470 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:03,470 - INFO - Entering finally block
2025-03-11 00:16:03,471 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:03,471 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:03,471 - INFO - Listener for group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827 stopped.
2025-03-11 00:16:03,471 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:03,475 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:03,478 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:03,492 - INFO - Database connection closed.
2025-03-11 00:16:04,756 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:04,756 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:04,757 - INFO - Entering finally block
2025-03-11 00:16:04,757 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:04,757 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:04,757 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:16:04,758 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:04,760 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:04,763 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:04,777 - INFO - Database connection closed.
2025-03-11 00:16:12,458 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:12,458 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:12,458 - INFO - Entering finally block
2025-03-11 00:16:12,458 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:12,459 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:12,459 - INFO - Listener for group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827 stopped.
2025-03-11 00:16:12,459 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:12,463 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:12,466 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:12,479 - INFO - Database connection closed.
2025-03-11 00:16:13,355 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c2e88b53474c286895498b, group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:16:13,356 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:16:13,413 - INFO - Entering finally block
2025-03-11 00:16:13,413 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:16:13,414 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:16:13,414 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b stopped.
2025-03-11 00:16:13,415 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:16:13,416 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:13,418 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:13,432 - INFO - Database connection closed.
2025-03-11 00:16:18,682 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:18,685 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:18,695 - INFO - Database connection closed.
2025-03-11 00:16:19,885 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:19,885 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:19,885 - INFO - Entering finally block
2025-03-11 00:16:19,885 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:19,886 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:19,886 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:16:19,886 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:19,889 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:19,906 - INFO - Database connection closed.
2025-03-11 00:16:33,403 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:33,404 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:33,404 - INFO - Entering finally block
2025-03-11 00:16:33,404 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:33,644 - INFO - Database connection successful.
2025-03-11 00:16:33,650 - INFO - Database connection closed.
2025-03-11 00:16:33,655 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:33,656 - INFO - Database connection successful.
2025-03-11 00:16:33,657 - INFO - Database connection closed.
2025-03-11 00:16:33,658 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:35,081 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:35,082 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:35,082 - INFO - Entering finally block
2025-03-11 00:16:35,082 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:35,252 - INFO - Database connection successful.
2025-03-11 00:16:35,254 - INFO - Database connection closed.
2025-03-11 00:16:35,256 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:35,257 - INFO - Database connection successful.
2025-03-11 00:16:35,258 - INFO - Database connection closed.
2025-03-11 00:16:35,259 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:35,926 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:35,941 - INFO - Database connection closed.
2025-03-11 00:16:37,282 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:37,297 - INFO - Database connection closed.
2025-03-11 00:16:41,933 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:41,934 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:45,205 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:45,206 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:48,795 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:48,796 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:51,192 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:51,192 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:53,821 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:53,821 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:53,821 - INFO - Entering finally block
2025-03-11 00:16:53,821 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:16:53,826 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:53,830 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:16:53,842 - INFO - Database connection closed.
2025-03-11 00:16:54,970 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:54,970 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:54,970 - INFO - Entering finally block
2025-03-11 00:16:54,970 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:54,970 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:54,971 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:16:54,971 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:16:54,974 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:16:54,991 - INFO - Database connection closed.
2025-03-11 00:17:02,746 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:02,746 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:02,746 - INFO - Entering finally block
2025-03-11 00:17:02,746 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:02,750 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:02,754 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:02,767 - INFO - Database connection closed.
2025-03-11 00:17:03,927 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:03,927 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:03,927 - INFO - Entering finally block
2025-03-11 00:17:03,927 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:03,927 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:03,928 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:17:03,928 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:03,931 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:03,947 - INFO - Database connection closed.
2025-03-11 00:17:07,226 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:07,226 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:07,226 - INFO - Entering finally block
2025-03-11 00:17:07,227 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:07,230 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:07,233 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:07,246 - INFO - Database connection closed.
2025-03-11 00:17:08,522 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c2e88b53474c286895498b, group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:08,522 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:08,522 - INFO - Entering finally block
2025-03-11 00:17:08,522 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:08,522 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:08,523 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b stopped.
2025-03-11 00:17:08,523 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:08,525 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:08,542 - INFO - Database connection closed.
2025-03-11 00:17:13,060 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:13,061 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:15,832 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:15,832 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:18,039 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:18,039 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:18,039 - INFO - Entering finally block
2025-03-11 00:17:18,040 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:18,045 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:18,047 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:18,060 - INFO - Database connection closed.
2025-03-11 00:17:19,048 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c2e88b53474c286895498b, group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:19,048 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:19,048 - INFO - Entering finally block
2025-03-11 00:17:19,048 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:19,048 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:19,049 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b stopped.
2025-03-11 00:17:19,049 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c2e88b53474c286895498b
2025-03-11 00:17:19,051 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:19,069 - INFO - Database connection closed.
2025-03-11 00:17:21,931 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:21,931 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:21,931 - INFO - Entering finally block
2025-03-11 00:17:21,931 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:17:21,935 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:21,938 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:17:21,952 - INFO - Database connection closed.
2025-03-11 00:17:22,962 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:22,962 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:22,962 - INFO - Entering finally block
2025-03-11 00:17:22,963 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:22,963 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:22,963 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:17:22,963 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:17:22,966 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:17:22,981 - INFO - Database connection closed.
2025-03-11 00:18:19,042 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:18:19,044 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:19,044 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,045 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,045 - INFO - Entering finally block
2025-03-11 00:18:19,045 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,045 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,045 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,046 - INFO - Entering finally block
2025-03-11 00:18:19,046 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:19,046 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:18:19,047 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:19,050 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=124339355782464
2025-03-11 00:18:19,051 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=124339355794464
2025-03-11 00:18:20,224 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:18:20,224 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:28,543 - INFO - Database connection successful.
2025-03-11 00:18:28,547 - INFO - Database connection closed.
2025-03-11 00:18:28,550 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:28,555 - INFO - Database connection successful.
2025-03-11 00:18:28,557 - INFO - Database connection closed.
2025-03-11 00:18:28,557 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:30,268 - INFO - Database connection successful.
2025-03-11 00:18:30,272 - INFO - Database connection closed.
2025-03-11 00:18:30,277 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:30,279 - INFO - Database connection successful.
2025-03-11 00:18:30,280 - INFO - Database connection closed.
2025-03-11 00:18:30,280 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:31,517 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:31,520 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:31,538 - INFO - Database connection closed.
2025-03-11 00:18:40,018 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:40,019 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:41,693 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:41,693 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:41,693 - INFO - Entering finally block
2025-03-11 00:18:41,693 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:41,693 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:41,694 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:41,695 - INFO - Listener for group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827 stopped.
2025-03-11 00:18:41,695 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:18:41,698 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:41,704 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:41,718 - INFO - Database connection successful.
2025-03-11 00:18:41,722 - INFO - Database connection closed.
2025-03-11 00:18:41,725 - INFO - Database connection closed.
2025-03-11 00:18:43,376 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:43,376 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:43,376 - INFO - Entering finally block
2025-03-11 00:18:43,376 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:43,376 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:43,377 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:43,377 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:18:43,378 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:43,381 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:43,384 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:43,400 - INFO - Database connection closed.
2025-03-11 00:18:46,626 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:46,629 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:46,640 - INFO - Database connection closed.
2025-03-11 00:18:49,603 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:49,603 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:49,661 - INFO - Entering finally block
2025-03-11 00:18:49,662 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:49,662 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:49,662 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:49,663 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:18:49,663 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:18:49,664 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:49,679 - INFO - Database connection closed.
2025-03-11 00:18:53,634 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:53,634 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:56,902 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:56,902 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:18:59,772 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:18:59,773 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:02,370 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:02,371 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:05,048 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:05,049 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:07,897 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:07,898 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:10,720 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:10,720 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:10,721 - INFO - Entering finally block
2025-03-11 00:19:10,721 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:10,721 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:10,728 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:10,732 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:10,747 - INFO - Database connection successful.
2025-03-11 00:19:10,749 - INFO - Database connection closed.
2025-03-11 00:19:10,750 - INFO - Database connection closed.
2025-03-11 00:19:12,131 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:12,131 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:12,131 - INFO - Entering finally block
2025-03-11 00:19:12,132 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:12,132 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:12,132 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:12,133 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:19:12,133 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:12,136 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:12,152 - INFO - Database connection closed.
2025-03-11 00:19:20,692 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:20,692 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:20,692 - INFO - Entering finally block
2025-03-11 00:19:20,692 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:20,693 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:20,696 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:20,699 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:20,712 - INFO - Database connection closed.
2025-03-11 00:19:21,875 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:21,875 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:21,875 - INFO - Entering finally block
2025-03-11 00:19:21,875 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:21,875 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:21,876 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:21,877 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:19:21,877 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:21,881 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:21,888 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:21,900 - INFO - Database connection closed.
2025-03-11 00:19:23,030 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c439e8c178f84e2942da67, group=67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67
2025-03-11 00:19:23,030 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67
2025-03-11 00:19:23,030 - INFO - Entering finally block
2025-03-11 00:19:23,030 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67
2025-03-11 00:19:23,030 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67
2025-03-11 00:19:23,031 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:23,031 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67 stopped.
2025-03-11 00:19:23,032 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c439e8c178f84e2942da67
2025-03-11 00:19:23,034 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:23,050 - INFO - Database connection closed.
2025-03-11 00:19:26,811 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:26,812 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:31,205 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:31,206 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:36,533 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:36,534 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:40,442 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:40,443 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:42,167 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:42,168 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:42,168 - INFO - Entering finally block
2025-03-11 00:19:42,168 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:42,168 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:42,177 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:42,178 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:42,195 - INFO - Database connection successful.
2025-03-11 00:19:42,197 - INFO - Database connection closed.
2025-03-11 00:19:42,200 - INFO - Database connection closed.
2025-03-11 00:19:43,842 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:43,843 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:43,843 - INFO - Entering finally block
2025-03-11 00:19:43,843 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:43,843 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:43,844 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:43,844 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:19:43,845 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:43,847 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:43,865 - INFO - Database connection closed.
2025-03-11 00:19:58,297 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:58,297 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:58,297 - INFO - Entering finally block
2025-03-11 00:19:58,297 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:19:58,298 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:58,302 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:58,305 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:19:58,319 - INFO - Database connection closed.
2025-03-11 00:19:59,585 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1001, '')
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1001, '')
2025-03-11 00:19:59,586 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:59,588 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:59,588 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:59,588 - INFO - Entering finally block
2025-03-11 00:19:59,588 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:59,588 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:59,589 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:59,589 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:19:59,589 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:19:59,590 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=131285197268672
2025-03-11 00:19:59,750 - INFO - Database connection successful.
2025-03-11 00:19:59,754 - INFO - Database connection closed.
2025-03-11 00:19:59,763 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:19:59,764 - INFO - Database connection successful.
2025-03-11 00:19:59,766 - INFO - Database connection closed.
2025-03-11 00:19:59,766 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:09,703 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:09,703 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:12,200 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:12,204 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:12,216 - INFO - Database connection closed.
2025-03-11 00:20:13,212 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:13,213 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:13,213 - INFO - Entering finally block
2025-03-11 00:20:13,213 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:13,213 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:13,214 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:13,214 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:20:13,215 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:13,226 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:13,243 - INFO - Database connection closed.
2025-03-11 00:20:18,394 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:18,395 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:19,976 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:19,976 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:19,976 - INFO - Entering finally block
2025-03-11 00:20:19,976 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:19,977 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:19,985 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:19,987 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:19,998 - INFO - Database connection successful.
2025-03-11 00:20:20,001 - INFO - Database connection closed.
2025-03-11 00:20:20,007 - INFO - Database connection closed.
2025-03-11 00:20:21,077 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c2e88b53474c286895498b, group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:20:21,078 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:20:21,078 - INFO - Entering finally block
2025-03-11 00:20:21,078 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:20:21,078 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:20:21,078 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:21,079 - INFO - Listener for group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b stopped.
2025-03-11 00:20:21,079 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c2e88b53474c286895498b
2025-03-11 00:20:21,082 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:21,097 - INFO - Database connection closed.
2025-03-11 00:20:23,386 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:23,386 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:23,386 - INFO - Entering finally block
2025-03-11 00:20:23,386 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:23,387 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:23,390 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:23,393 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:23,405 - INFO - Database connection closed.
2025-03-11 00:20:30,546 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:30,547 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:33,467 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c27b205ae9c75d5093cdbe, group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:33,467 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:33,467 - INFO - Entering finally block
2025-03-11 00:20:33,467 - INFO - Moving chat from Redis to MongoDB for group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:33,468 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:33,468 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:33,469 - INFO - Listener for group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:20:33,469 - INFO - Unsubscribed from group 67c20eda90b1b4e0beef6827-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:33,473 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:33,489 - INFO - Database connection closed.
2025-03-11 00:20:38,511 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:38,511 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:38,511 - INFO - Entering finally block
2025-03-11 00:20:38,511 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:38,512 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:38,521 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:38,529 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:38,533 - INFO - Database connection successful.
2025-03-11 00:20:38,536 - INFO - Database connection closed.
2025-03-11 00:20:38,544 - INFO - Database connection closed.
2025-03-11 00:20:39,511 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c27b205ae9c75d5093cdbe, group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:39,511 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:39,511 - INFO - Entering finally block
2025-03-11 00:20:39,511 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:39,511 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:39,512 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:39,512 - INFO - Listener for group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe stopped.
2025-03-11 00:20:39,512 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c27b205ae9c75d5093cdbe
2025-03-11 00:20:39,515 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:39,532 - INFO - Database connection closed.
2025-03-11 00:20:50,040 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:50,040 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:50,040 - INFO - Entering finally block
2025-03-11 00:20:50,041 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:20:50,041 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:50,045 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:50,048 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:50,062 - INFO - Database connection closed.
2025-03-11 00:20:54,131 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:54,132 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:20:58,489 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:20:58,490 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:02,676 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:02,677 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:06,797 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:06,798 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:10,419 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:10,419 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:15,268 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:15,269 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:37,294 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:37,295 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:21:56,650 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:21:56,651 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:01,713 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:22:01,713 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:04,421 - INFO - Creating new Redis pub/sub client at localhost:6379
2025-03-11 00:22:04,422 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:06,838 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c439e8c178f84e2942da67, group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:22:06,838 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:22:06,838 - INFO - Entering finally block
2025-03-11 00:22:06,838 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:22:06,839 - INFO - Removed WebSocket group and cancelled Redis listener: group=67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:22:06,839 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:06,840 - INFO - Listener for group 67c20beebeb874032b0c381c-67c439e8c178f84e2942da67 stopped.
2025-03-11 00:22:06,840 - INFO - Unsubscribed from group 67c20beebeb874032b0c381c-67c439e8c178f84e2942da67
2025-03-11 00:22:06,847 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:06,868 - INFO - Database connection closed.
2025-03-11 00:22:06,882 - INFO - Database connection successful.
2025-03-11 00:22:06,884 - INFO - Database connection closed.
2025-03-11 00:22:53,376 - WARNING - WebSocket disconnected: current_user=67c20eda90b1b4e0beef6827, other=67c20beebeb874032b0c381c, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,376 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,376 - INFO - Entering finally block
2025-03-11 00:22:53,377 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,377 - WARNING - WebSocket disconnected: current_user=67c20beebeb874032b0c381c, other=67c20eda90b1b4e0beef6827, group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,377 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,377 - INFO - Entering finally block
2025-03-11 00:22:53,377 - INFO - Moving chat from Redis to MongoDB for group=67c20beebeb874032b0c381c-67c20eda90b1b4e0beef6827
2025-03-11 00:22:53,378 - ERROR - WebSocket error: user_id=67c20beebeb874032b0c381c, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:22:53,378 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:53,379 - ERROR - WebSocket error: user_id=67c20eda90b1b4e0beef6827, error=(1012, None)
Traceback (most recent call last):
  File "/home/sourabh/Desktop/chat_application/chat_application/app/routes/websockets.py", line 60, in user_status
    data = await websocket.receive_text()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 119, in receive_text
    self._raise_on_disconnect(message)
  File "/home/sourabh/Desktop/chat_application/chat_application/venv/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1012, None)
2025-03-11 00:22:53,379 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:53,380 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:53,381 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:53,382 - INFO - WebSocket connection closed: user_id=67c20beebeb874032b0c381c, websocket_id=131285144885424
2025-03-11 00:22:53,383 - INFO - WebSocket connection closed: user_id=67c20eda90b1b4e0beef6827, websocket_id=131285197265696
2025-03-11 00:22:53,400 - INFO - Database connection successful.
2025-03-11 00:22:53,401 - INFO - Database connection closed.
2025-03-11 00:22:53,403 - INFO - Database connection successful.
2025-03-11 00:22:53,404 - INFO - Database connection closed.
2025-03-11 00:22:55,025 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:22:55,025 - INFO - Returning Redis client instance from connection pool
2025-03-11 00:22:59,336 - INFO - Created new Redis connection pool at localhost:6379
2025-03-11 00:22:59,336 - INFO - Returning Redis client instance from connection pool
